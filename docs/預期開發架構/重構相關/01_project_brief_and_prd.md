# 專案簡報與產品需求文件 - OpenManus Linus 式重構

---

**文件版本 (Document Version):** `v1.0`
**最後更新 (Last Updated):** `2025-01-21`
**主要作者 (Lead Author):** `系統架構師`
**審核者 (Reviewers):** `技術負責人, 開發團隊`
**狀態 (Status):** `已批准 (Approved)`

---

## 目錄 (Table of Contents)

1. [專案總覽 (Project Overview)](#第-1-部分專案總覽-project-overview)
2. [商業目標 (Business Objectives) - 「為何做？」](#第-2-部分商業目標-business-objectives---為何做)
3. [使用者故事與允收標準 (User Stories & UAT) - 「做什麼？」](#第-3-部分使用者故事與允收標準-user-stories--uat---做什麼)
4. [範圍與限制 (Scope & Constraints)](#第-4-部分範圍與限制-scope--constraints)
5. [待辦問題與決策 (Open Questions & Decisions)](#第-5-部分待辦問題與決策-open-questions--decisions)

---

**目的**: 本文件定義 OpenManus AI Agent 系統的完全重構專案，基於 Linus Torvalds 的技術哲學，從過度設計的企業級架構重構為極簡、實用的系統。

---

## 第 1 部分：專案總覽 (Project Overview)

| 區塊 | 內容 |
| :--- | :--- |
| **專案名稱** | OpenManus Linus 式重構專案 (Project Simplicity) |
| **狀態** | 開發中 |
| **目標發布日期** | 2025-02-11 (3 週衝刺) |
| **核心團隊** | Tech Lead: Linus-style Architect<br>Senior Developer: Python Expert<br>Frontend Developer: Vanilla JS Expert |

---

## 第 2 部分：商業目標 (Business Objectives) - 「為何做？」

*Linus 哲學：「不要修補爛設計。刪掉它，重新開始。」*

| 區塊 | 內容 |
| :--- | :--- |
| **1. 背景與痛點** | **當前系統問題**:<br>- 2000+ 行混亂代碼，無人能理解<br>- 6 個入口點，用戶不知道該用哪個<br>- 配置分散在 3 個不同格式的文件中<br>- 3 層無意義繼承，為了抽象而抽象<br>- 工具硬編碼，無法動態擴展<br><br>**影響**: 新開發者需要 1 週才能理解系統，維護成本極高，用戶體驗差 |
| **2. 策略契合度** | **符合 Linux 內核開發原則**:<br>- Good Taste: 消除所有特殊情況<br>- Never Break Userspace: 簡化用戶體驗<br>- Practicality Beats Purity: 實用主義至上<br>- Simplicity is Prerequisite: 簡潔為先<br><br>支持組織的技術債務清理戰略目標 |
| **3. 成功指標 (Success Metrics)** | **主要指標**: 代碼行數從 2000+ 減少到 < 500 行 (75% 減少)<br>**次要指標**: <br>- 新開發者理解時間從 1 週減少到 5 分鐘<br>- 冷啟動時間 < 2 秒<br>- 配置文件從 3 個減少到 1 個<br>- 入口點從 6 個減少到 1 個 |

---

## 第 3 部分：使用者故事與允收標準 (User Stories & UAT) - 「做什麼？」

*以用戶為中心，定義最核心的使用場景*

### 3.1 主要使用者群體

| 使用者類型 | 描述 | 核心需求 |
| :--- | :--- | :--- |
| **終端用戶** | 需要 AI 助手幫助完成任務 | 簡單、快速、可靠的 AI 交互 |
| **開發者** | 需要理解/修改/擴展系統 | 清晰的代碼結構，容易理解 |
| **系統管理員** | 需要部署和維護系統 | 零配置部署，簡單的故障排除 |

### 3.2 核心使用者故事

#### 故事 1: 快速啟動
**作為** 終端用戶
**我希望** 能夠快速啟動 AI 助手
**以便於** 立即開始工作，不被複雜的設置困擾

**允收標準**:
- [ ] 用戶執行 `python main.py` 即可啟動
- [ ] 冷啟動時間 < 2 秒
- [ ] 無需任何預先配置
- [ ] 錯誤消息清楚易懂

#### 故事 2: 簡單對話
**作為** 終端用戶
**我希望** 能夠自然地與 AI 對話
**以便於** 完成 Python 編程、網頁瀏覽、文件操作等任務

**允收標準**:
- [ ] 支持命令行交互模式
- [ ] 支持 Web 界面模式
- [ ] 響應時間 < 1 秒
- [ ] 支持工具調用 (Python, Browser, Files)

#### 故事 3: 工具擴展
**作為** 開發者
**我希望** 能夠輕鬆添加新的工具
**以便於** 擴展系統功能而不修改核心代碼

**允收標準**:
- [ ] 新工具只需要實現一個 `execute(input: str) -> str` 函數
- [ ] 在 `config.yaml` 中添加工具名稱即可啟用
- [ ] 無需修改任何核心代碼
- [ ] 工具隔離，不會相互影響

#### 故事 4: 代碼理解
**作為** 開發者
**我希望** 能夠快速理解系統架構
**以便於** 進行維護和功能開發

**允收標準**:
- [ ] 5 分鐘內理解整體架構
- [ ] 每個模組職責單一且清晰
- [ ] 沒有無意義的抽象層
- [ ] 代碼即文檔，不需要額外註釋

### 3.3 Web 界面使用者故事

#### 故事 5: Web 聊天界面
**作為** 終端用戶
**我希望** 能夠通過瀏覽器使用 AI 助手
**以便於** 在任何設備上都能訪問

**允收標準**:
- [ ] `python main.py --web` 啟動 Web 模式
- [ ] 原生 HTML/CSS/JS 界面，無框架依賴
- [ ] Hacker 風格的黑色主題
- [ ] WebSocket 實時通信
- [ ] 支持思考過程顯示

---

## 第 4 部分：範圍與限制 (Scope & Constraints)

### 4.1 專案範圍 (In Scope)

#### 包含功能:
- ✅ **核心 Agent 邏輯**: prompt -> response 循環
- ✅ **基本工具支持**: Python 執行、Browser 操作、文件處理
- ✅ **命令行界面**: 交互式和直接執行模式
- ✅ **Web 界面**: 簡單的聊天界面
- ✅ **配置管理**: 統一的 YAML 配置
- ✅ **動態工具載入**: 插件式工具架構

#### 技術約束:
- ✅ **Python 3.10+**: 使用現代 Python 特性
- ✅ **零框架前端**: 原生 HTML/CSS/JavaScript
- ✅ **最小依賴**: FastAPI (WebSocket), requests, PyYAML
- ✅ **代碼行數限制**: 總計 < 900 行

### 4.2 明確排除 (Out of Scope)

#### 不包含功能:
- ❌ **用戶認證系統**: 單用戶系統
- ❌ **數據庫集成**: 無需持久化存儲
- ❌ **多模型支持**: 專注於 OpenAI API
- ❌ **集群部署**: 單機運行
- ❌ **高級分析**: 基本使用統計即可

#### 技術排除:
- ❌ **React/Vue/Angular**: 避免前端框架複雜性
- ❌ **PostgreSQL/MongoDB**: 避免數據庫複雜性
- ❌ **Docker**: 避免容器化開發復雜性
- ❌ **微服務架構**: 單體應用即可
- ❌ **複雜設計模式**: 避免過度抽象

### 4.3 技術限制 (Technical Constraints)

| 限制類型 | 具體要求 | 理由 |
| :--- | :--- | :--- |
| **代碼行數** | 後端 < 500 行，前端 < 400 行 | Linus 式簡潔原則 |
| **啟動時間** | < 2 秒冷啟動 | 用戶體驗要求 |
| **響應時間** | < 1 秒處理響應 | 實時交互要求 |
| **記憶體使用** | < 100MB 運行時 | 資源效率要求 |
| **依賴庫數量** | < 10 個外部依賴 | 簡潔性要求 |

### 4.4 品質標準 (Quality Gates)

#### 必須通過的檢查:
1. **Linus 式品味測試**: 代碼中沒有特殊情況處理
2. **5 分鐘理解測試**: 新開發者 5 分鐘內理解架構
3. **零文檔測試**: 代碼本身即為文檔，無需額外說明
4. **單一職責測試**: 每個函數只做一件事
5. **統一接口測試**: 所有工具使用相同的接口

---

## 第 5 部分：待辦問題與決策 (Open Questions & Decisions)

### 5.1 已確認決策 (Confirmed Decisions)

| 決策 | 選擇 | 理由 | 決策者 | 日期 |
| :--- | :--- | :--- | :--- | :--- |
| **架構模式** | 函數式 + 簡單類 | Linus 式簡潔原則 | Tech Lead | 2025-01-21 |
| **前端技術** | 原生 HTML/CSS/JS | 避免框架複雜性 | Tech Lead | 2025-01-21 |
| **配置格式** | YAML | 人類可讀，結構化 | Tech Lead | 2025-01-21 |
| **工具接口** | `execute(str) -> str` | 統一簡單接口 | Tech Lead | 2025-01-21 |
| **Web 框架** | FastAPI (僅 WebSocket) | 最小化 Web 依賴 | Tech Lead | 2025-01-21 |

### 5.2 待討論問題 (Open Questions)

| 問題 | 選項 | 影響 | 決策期限 | 負責人 |
| :--- | :--- | :--- | :--- | :--- |
| **錯誤重試機制** | 1) 簡單重試 2) 無重試 | 用戶體驗 vs 複雜度 | Week 1 | Tech Lead |
| **日誌級別** | 1) 簡單 print 2) logging 模組 | 調試能力 vs 代碼複雜度 | Week 1 | Tech Lead |
| **配置驗證** | 1) Pydantic 2) 手動驗證 | 錯誤處理 vs 依賴複雜度 | Week 2 | Tech Lead |

### 5.3 風險與緩解 (Risks & Mitigations)

| 風險 | 可能性 | 影響 | 緩解措施 | 負責人 |
| :--- | :--- | :--- | :--- | :--- |
| **過度簡化導致功能不足** | 中 | 高 | 持續用戶反饋，迭代改進 | PM |
| **缺少框架導致開發效率低** | 低 | 中 | 保持代碼簡潔，提高可讀性 | Tech Lead |
| **原生前端維護困難** | 低 | 中 | 嚴格控制前端代碼行數 | Frontend Dev |

### 5.4 成功標準檢查清單 (Success Criteria Checklist)

#### 第 1 週檢查點:
- [ ] `python main.py` 能正常啟動
- [ ] 基本的 prompt -> response 流程工作
- [ ] Python 工具能執行代碼
- [ ] 代碼行數 < 300 行

#### 第 2 週檢查點:
- [ ] Web 界面能正常工作
- [ ] WebSocket 通信穩定
- [ ] 所有三個基本工具正常工作
- [ ] 前端代碼 < 400 行

#### 第 3 週檢查點:
- [ ] 所有使用者故事通過 UAT
- [ ] 新開發者 5 分鐘理解測試通過
- [ ] 性能指標全部達標
- [ ] 代碼品質檢查全部通過

---

**批准簽字**:
- Tech Lead: ✅ 已批准 (2025-01-21)
- 開發團隊: ✅ 已批准 (2025-01-21)

**下一步**: 開始 [架構與設計文件](./02_architecture_and_design_document.md) 的編寫